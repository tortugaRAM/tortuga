# Full Course
ram.ai.new.mainState.Body:
  states:
    start:
      type: Start
    gate:
      type: GateTask
      init:
        taskDepth: 4
        forwardDistance: 12
        success: gateForward
        failure: end
        duration: 90

    gateForward:
      type: Move
      init:
        x: 1
        y: 0

    boopBuoy:
      type: BoopBuoyTask
      init:
        boopDepth: 8
        endDepth: 4
        success: boopForward
        failure: shootTheMoonYaw

    shootTheMoonYaw:
      type: TurnTo
      init:
        angle: 25

    shootTheMoonDistance:
      type: Forward
      init:
        distance: 25

    boopForward:
      type: Forward
      init:
        distance: 1

    pipeAlignBuoyCP:
      type: PipeAlign
      init:
        searchDist: 3

    pipeAlignBuoyNCP:
      type: PipeAlign
      init:
        searchDist: 3

    moveForward:
      type: Forward
      init:
        distance: 6.5

    storeBuoyPipe:
      type: PipeCheckpoint
      init:
        checkpoint: pipe1
        nextCheckpoint: pipe1next
        distanceToNextPipe: 6.5

    gotoUprightsPipe:
      type: GotoPipe
      init:
        prevCheckpoint: pipe1
        nextCheckpoint: pipe1next

    pipeAlignUprightsCP:
      type: PipeAlign
      init:
        searchDist: 3.5

    pipeAlignUprightsNCP:
      type: PipeAlign
      init:
        searchDist: 3.5

    storeUprightsPipe:
      type: PipeCheckpoint
      init:
        checkpoint: pipe2
        nextCheckpoint: pipe2next
        distanceToNextPipe: 6.5

    moveToBins:
      type: Forward
      init:
        distance: 6.5

#    uprights:
#      type: UprightsTask
#      init:
#        taskDepth: 8
#        returnDepth: 4
#        uprightsSearchDistance: 7
#	     endRange: 80
#        rectWidth: 1
#        rectLength: 2.5
#        success: gotoUprightsPipe
#        failure: gotoUprightsPipe
#        duration: 180


    bins:
      type: BinsTask
      init:
        binSymbol1: 1
        binSymbol2: 2
        searchDist: 10
        hoverTime: 15
        success: strafeTorps
        failure: sonarPinger1
        duration: 180

    strafeTorps:
      type: Move
      init:
        x: 0
        y: 1

    torps:
      type: TorpedoTask
      init:
        configNode: {}
        success: sonarPinger1
        failure: sonarPinger1
        duration: 120

    sonarPinger1:
      type: SonarNavigationTask
      init:
        success: surface
        failure: surface
        startDepth: 4
        shortDepth: 8
        endDepth: 0
        duration: 100000000

    sonarDive:
      type: DiveTo
      init:
        depth: 4

    sonarManip:
      type: SonarManipTask
      init:
        siteSearchDistance: 3
        boxX: 1.5
        boxY: 1.5
        success: pogo
        failure: sonarPinger4
        duration: 180

    pogo:
      type: PogoTask
      init: 
        pogoHeight: 1.2
        pogoWidth: 1.2
        pogoShift: .15
        pogoShiftV: .45
        attackHeight: 11.9
        success: sonarPinger2
        failure: sonarPinger2
        duration: 180

    sonarPinger2:
      type: SonarNavigationTask
      init:
        success: releaseOne
        failure: surface
        startDepth: 6
        shortDepth: 8
        endDepth: 8
        duration: 180

    releaseOne:
      type: ManipRelease
      init:
        release: 1
        wait: 7

    sonarPinger3:
      type: SonarNavigationTask
      init:
        success: releaseOther
        failure: surface
        startDepth: 6
        shortDepth: 8
        endDepth: 8
        duration: 180

    releaseOther:
      type: ManipRelease
      init:
        release: 2
        wait: 7

    sonarPinger4:
      type: SonarNavigationTask
      init:
        success: releaseAll
        failure: surface
        startDepth: 6
        shortDepth: 8
        endDepth: 8
        duration: 90

    releaseAll:
      type: ManipRelease
      init:
        release: 0
        wait: 7

    surface:
      type: DiveTo
      init:
        depth: 0

#    gotoTorpBinPipe:
#      type: GotoPipe
#      init:
#        prevCheckpoint: pipe2
#        nextCheckpoint: pipe2next
    end:
      type: End
      
  transitions:
    - [start, next, gate]
    - [gateForward, next, pipeAlignBuoyBoop]
    - [pipeAlignBuoyBoop, next, boopBuoy]
    - [boopForward, next, pipeAlignBuoyNCP]

    - [strafeTorps, next, torps]


    #checkpoints
    - [pipeAlignBuoyCP, complete, storeBuoyPipe]
    - [storeBuoyPipe, next, gotoUprightsPipe]
    - [gotoUprightsPipe, next, pipeAlignUprightsCP]
    - [pipeAlignUprightsCP, complete, storeUprightsPipe]
    - [storeUprightsPipe, next, bins]

    #no checkpoints
    - [pipeAlignBuoyNCP, complete, moveForward]
    - [moveForward, next, pipeAlignUprightsNCP]
    - [pipeAlignUprightsNCP, complete, moveToBins]
    - [moveToBins, next, bins]

    #Shoot The Moon Sonar
    - [shootTheMoonYaw, next, shootTheMoonDistance]
    - [shootTheMoonDistance, next, sonarPinger1]

    - [releaseOne, next, sonarPinger3]
    - [releaseOther, next, surface]
    - [releaseAll, next, surface]
    - [surface, next, sonarDive]
    - [sonarDive, next, sonarManip]
